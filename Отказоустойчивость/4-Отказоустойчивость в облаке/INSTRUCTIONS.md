# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–¥–∞–Ω–∏—è

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è GCP
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
3. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Load Balancer —Å Health Checks
4. ‚úÖ Firewall Rules –¥–ª—è HTTP —Ç—Ä–∞—Ñ–∏–∫–∞
5. ‚úÖ Outputs –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
6. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è README.md –∑–∞–ø–æ–ª–Ω–µ–Ω–∞

## ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤–∞–º

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
cd "terraform/"
terraform init
terraform apply
```

**–í–ê–ñ–ù–û:** –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ GCP –∏ –Ω–∞—á–Ω–µ—Ç —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ (~$0.10-0.15/—á–∞—Å).

### –®–∞–≥ 2: –ü–æ–¥–æ–∂–¥–∞—Ç—å 3-5 –º–∏–Ω—É—Ç

Nginx —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è –¥–ª—è:
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ –æ–±–µ–∏—Ö VM
- –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è health checks
- –ê–∫—Ç–∏–≤–∞—Ü–∏–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
# –ü–æ–ª—É—á–∏—Ç—å IP –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
terraform output -raw load_balancer_ip

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health checks
gcloud compute backend-services get-health web-backend-service --global

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl http://$(terraform output -raw load_balancer_ip)
```

### –®–∞–≥ 4: –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

1. **Load Balancer:**
   https://console.cloud.google.com/net-services/loadbalancing?project=n8n-prod-461317

2. **Backend Service (Health Checks):**
   https://console.cloud.google.com/net-services/loadbalancing/details/http/web-url-map?project=n8n-prod-461317

3. **VM Instances:**
   https://console.cloud.google.com/compute/instances?project=n8n-prod-461317

4. **Nginx —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫:**
   http://<IP_–ë–ê–õ–ê–ù–°–ò–†–û–í–©–ò–ö–ê>

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ –ø–∞–ø–∫—É `screenshots/`.

### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç—å README.md

–ó–∞–º–µ–Ω–∏—Ç–µ –∑–∞–≥–ª—É—à–∫–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏:
```markdown
![–°–∫—Ä–∏–Ω—à–æ—Ç 1 - –°—Ç–∞—Ç—É—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞](screenshots/load_balancer.png)
```

### –®–∞–≥ 6: –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ GitHub

```bash
cd /Users/andrey/SciFlow/netology_homework
git add "–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å/4-–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≤ –æ–±–ª–∞–∫–µ/"
git commit -m "–í—ã–ø–æ–ª–Ω–µ–Ω–æ –î–ó: –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≤ –æ–±–ª–∞–∫–µ (GCP)"
git push github github-main
```

### –®–∞–≥ 7: –£–î–ê–õ–ò–¢–¨ –†–ï–°–£–†–°–´!

‚ö†Ô∏è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è:

```bash
cd terraform/
terraform destroy
```

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ: `yes`

–≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤.

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
4-–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≤ –æ–±–ª–∞–∫–µ/
‚îú‚îÄ‚îÄ README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å —Ä–µ—à–µ–Ω–∏–µ–º
‚îú‚îÄ‚îÄ INSTRUCTIONS.md              # –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
‚îú‚îÄ‚îÄ COMMANDS.md                  # –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ 4.md                         # –ò—Å—Ö–æ–¥–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ screenshots/                 # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–ª—è –æ—Ç—á–µ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ .gitkeep
‚îî‚îÄ‚îÄ terraform/                   # Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ provider.tf              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è GCP
    ‚îú‚îÄ‚îÄ variables.tf             # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ network.tf               # –°–µ—Ç—å –∏ Firewall
    ‚îú‚îÄ‚îÄ compute.tf               # –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã
    ‚îú‚îÄ‚îÄ load_balancer.tf         # –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
    ‚îú‚îÄ‚îÄ outputs.tf               # Outputs
    ‚îú‚îÄ‚îÄ startup-script.sh        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
    ‚îú‚îÄ‚îÄ .gitignore              # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Git
    ‚îî‚îÄ‚îÄ README_TERRAFORM.md      # –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–¥–∞—á–µ–π

- [ ] Terraform apply –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] –û–±–µ VM –≤ —Å—Ç–∞—Ç—É—Å–µ RUNNING
- [ ] Health checks –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç HEALTHY
- [ ] Load Balancer –≤ —Å—Ç–∞—Ç—É—Å–µ ACTIVE
- [ ] Nginx –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
- [ ] –°–¥–µ–ª–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- [ ] README.md —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- [ ] –ö–æ–¥ –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ GitHub
- [ ] –†–µ—Å—É—Ä—Å—ã –£–î–ê–õ–ï–ù–´ —á–µ—Ä–µ–∑ terraform destroy

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- 2 x e2-micro VM: ~$0.01/—á–∞—Å –∫–∞–∂–¥–∞—è
- HTTP(S) Load Balancer: ~$0.05/—á–∞—Å
- –¢—Ä–∞—Ñ–∏–∫: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

**–ò—Ç–æ–≥–æ:** ~$0.10-0.15/—á–∞—Å

## üÜò Troubleshooting

### Health checks UNHEALTHY?
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall rules
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Nginx –Ω–∞ VM

### 502 Bad Gateway?
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø–µ—Ä–≤—ã–µ 3-5 –º–∏–Ω—É—Ç
- Health checks –µ—â–µ –Ω–µ –ø—Ä–æ—à–ª–∏
- –ü—Ä–æ—Å—Ç–æ –ø–æ–¥–æ–∂–¥–∏—Ç–µ

### Terraform errors?
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é: `gcloud auth application-default login`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–µ–∫—Ç: `gcloud config get-value project`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Terraform GCP Provider](https://registry.terraform.io/providers/hashicorp/google/latest/docs)
- [GCP Load Balancer](https://cloud.google.com/load-balancing/docs)
- [GCP Compute Engine](https://cloud.google.com/compute/docs)

---

**–£–¥–∞—á–∏! –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ –∑–∞–±—É–¥—å—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã!** üöÄ

